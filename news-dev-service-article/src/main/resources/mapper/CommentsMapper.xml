<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.article.mapper.CommentsMapper">
    <resultMap id="BaseResultMap" type="com.pojo.Comments">
        <!--
          WARNING - @mbg.generated
        -->
        <id column="id" property="id" jdbcType="VARCHAR"/>
        <result column="writer_id" property="writerId" jdbcType="VARCHAR"/>
        <result column="father_id" property="fatherId" jdbcType="VARCHAR"/>
        <result column="article_id" property="articleId" jdbcType="VARCHAR"/>
        <result column="article_title" property="articleTitle" jdbcType="VARCHAR"/>
        <result column="article_cover" property="articleCover" jdbcType="VARCHAR"/>
        <result column="comment_user_id" property="commentUserId" jdbcType="VARCHAR"/>
        <result column="comment_user_nickname" property="commentUserNickname" jdbcType="VARCHAR"/>
        <result column="comment_user_face" property="commentUserFace" jdbcType="VARCHAR"/>
        <result column="content" property="content" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <select id="queryArticleCommentList" resultType="com.pojo.vo.CommentsVO" parameterType="Map">
        SELECT t1.id                    as commentId,
               t1.father_id             as fatherId,
               t1.comment_user_id       as commentUserId,
               t1.comment_user_nickname as commentUserNickname,
               t1.comment_user_face     as commentUserFace,
               t1.article_id            as articleId,
               t1.content               as content,
               t1.create_time           as createTime,
               t2.comment_user_nickname as quoteUserNickname,
               t2.content               as quoteContent
        FROM tb_comments t1
                 LEFT JOIN tb_comments t2 ON t1.father_id = t2.id
        WHERE t1.article_id = #{paramMap.articleId}
        ORDER BY t1.create_time DESC
    </select>

</mapper>